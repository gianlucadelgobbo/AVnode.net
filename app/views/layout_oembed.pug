doctype html
html(lang=session.current_lang)
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')

    title #{title} - AVnode.net
    meta(name="robots" content="index, follow")
    link(href=canonical rel="canonical")
    if jsonld
      meta(name="description" content=jsonld.description)
      meta(property="og:title" content=title)
      meta(property="fb:app_id" content="1243968378972425")
      meta(property="og:url" content=canonical)
      meta(property="og:type" content=jsonld["@type"]==="Person" || jsonld["@type"]==="PerformingGroup" ? "profile" : "website")
      meta(property="og:description" content=jsonld.description)
      meta(property="og:image" content=jsonld.image)
      meta(property="og:site_name" content="AVnode.net")
      meta(property="og:locale" content=config.locales_iso[session.current_lang])
      if jsonld.video && jsonld.video_width && jsonld.video_height
        meta(property="og:video" content=jsonld.video)
        meta(property="og:video:width" content=jsonld.video_width)
        meta(property="og:video:height" content=jsonld.video_height)
    link(rel='shortcut icon', href='/icons/favicon.ico', type='image/x-icon')
    link(rel='apple-touch-icon', href='/icons/apple-touch-icon.png')
    link(rel='apple-touch-icon', sizes='57x57', href='/icons/apple-touch-icon-57x57.png')
    link(rel='apple-touch-icon', sizes='72x72', href='/icons/apple-touch-icon-72x72.png')
    link(rel='apple-touch-icon', sizes='76x76', href='/icons/apple-touch-icon-76x76.png')
    link(rel='apple-touch-icon', sizes='114x114', href='/icons/apple-touch-icon-114x114.png')
    link(rel='apple-touch-icon', sizes='120x120', href='/icons/apple-touch-icon-120x120.png')
    link(rel='apple-touch-icon', sizes='144x144', href='/icons/apple-touch-icon-144x144.png')
    link(rel='apple-touch-icon', sizes='152x152', href='/icons/apple-touch-icon-152x152.png')
    link(rel='apple-touch-icon', sizes='180x180', href='/icons/apple-touch-icon-180x180.png')

    link(rel='stylesheet', type='text/css', href='/css/font-awesome/font-awesome.css')
    link(rel='stylesheet', type='text/css', href='/css/video-js.min.css')
    link(rel="stylesheet", type='text/css', href='/css/jquery-ui.min.css')
    link(rel='stylesheet', type='text/css', href='/css/oembed.css')
    script(type="application/ld+json")
      !=JSON.stringify(jsonld)

  body
    block content

    script(src='/js/combo.min.js')
    script(src='/js/video.min.js')
    script(src='/js/videojs-logo.min.js')
    script(src='/js/videojs-playlist.min.js')
    script(src='/js/imagesloaded.pkgd.min.js')
    script(src='/js/jquery-ui.min.js')
    //script(src="/js/vjtv.js")
    script(src="/js/cookielawinfo.min.js")
    script(async src="https://www.googletagmanager.com/gtag/js?id=UA-124799696-1")
    include partials/modals/cookielawinfo
    script.
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-124799696-1');
    script.
      var logo_url = "!{canonical}"

      var player = videojs('my-video', {
        controls: true,
        autoplay: false,
        preload: 'auto',
        fluid: true,
        playbackRates: [1, 1.5, 2],
        liveui: false
      }, ()=>{
        setTimeout(()=>{
          $('.vjs-logo-content').html($('.toclone').html());
        }, 500)
      });

      // Title Author
      var myTitleAuthor = player.logo({
        image: 'https://avnode.net/images/empty.png',
        height: 50,
        offsetH: 0,
        offsetV: 0,
        fadeDelay: null,
        hideOnReady: false,
        position: 'top-left',
        width: 150
      });
      player.on("useractive",()=>{
        myTitleAuthor.show();
      })
      player.on("userinactive",()=>{
        myTitleAuthor.hide();
      })
      player.getChild('ControlBar').removeChild("PictureInPictureToggle");
      player.getChild('ControlBar').removeChild("SeekToLive");

      // Modal Embed
      var myModal
      player.ready(function() {
        myPlayer = this;
        options = {};
        var contentEl = document.createElement('div');
        // probably better to just build the entire thing via DOM methods
        contentEl.innerHTML = '<h1 class="vp-share-title vp-share-title--embed">Embed</h1><p class="vp-share-subtitle vp-share-subtitle--embed">Add this video to your site with the embed code below.</p><textarea id="copy_content" class="form-control"><iframe title=&quot;avnode-player&quot; src=&quot;'+logo_url+'?oembed=1&quot; width=&quot;640&quot; height=&quot;290&quot; frameborder=&quot;0&quot; allowfullscreen></iframe></textarea><br /><button type="button" id="mycopy" onclick="myCopy(\'copy_content\', \'mycopy\')" class="btn btn-primary btn-block" data-label="Copy" data-success-label="Copied!">Copy</button>';
        options.content = contentEl;
        options.label = 'embed';
        var ModalDialog = videojs.getComponent('ModalDialog');
        myModal = new ModalDialog(player, options);
        myModal.addClass('vjs-my-custom-modal');
        player.addChild(myModal);
        
        //myModal.open();
      });
      function myCopy(id, button) {
        /* Get the text field */
        var copyText = document.getElementById(id);
        console.log(document.getElementById(button).dataset.label);
        /* Select the text field */
        copyText.select();
        copyText.setSelectionRange(0, 99999); /*For mobile devices*/

        /* Copy the text inside the text field */
        document.execCommand("copy");

        /* Alert the copied text */
        document.getElementById(button).innerHTML = document.getElementById(button).dataset.successLabel
        //alert("Copied the text: " + copyText.value);
      }

      class ToolbarLogo extends videojs.getComponent('Button') {
        constructor(player, options = {}) {
          super(player, options);
          this.addClass('vjs-avnode-logo');
        }
        /**
        * Toggle the subtitle track on and off upon click
        handleClick(_e) {
        }
        */
      }
      player.getChild('ControlBar').addChild(new ToolbarLogo(player));
      $('.vjs-avnode-logo').html('<a class="navbar-brand" href="'+logo_url+'" target="_blanck" title="AVnode.net"><img class="main_logo" src="https://avnode.net/images/LogoAVnode-bar.svg" height="20" alt="AVnode.net"></a>')

      

